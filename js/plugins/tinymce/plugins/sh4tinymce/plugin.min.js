tinymce.PluginManager.requireLangPack("sh4tinymce"),tinymce.PluginManager.add("sh4tinymce",function(e,t){function a(){function t(e){for(var t=e.split(";"),a={},l=0;l<t.length;l++){var i=t[l].split(":");a[i[0].replace(/\-/g,"")]=i[1]}tinymce.each(a,function(e,t){"brush"==t?r.language!=e&&(r.language=e):(e="true"==e?!0:"false"==e?!1:e,"highlight"==t&&(e=e.replace(/\[/g,"").replace(/\]/g,"")),r[t]=e)})}function a(t){var a=t.data.code;a=a.replace(/\</g,"&lt;").replace(/\>/g,"&gt;");{var l=t.data.language?t.data.language:g,n=(t.data.collapse!=s.collapse?";collapse:"+t.data.collapse:"",t.data.autolinks!=s.autolinks?";auto-links:"+t.data.autolinks:"",t.data.gutter!=s.gutter?";gutter:"+t.data.gutter:"",t.data.htmlscript!=s.htmlscript?";html-script:"+t.data.htmlscript:"",t.data.toolbar!=s.toolbar?";toolbar:"+t.data.toolbar:"",t.data.firstline!=s.firstline?";first-line:"+t.data.firstline:"",-1!=t.data.highlight.indexOf(",")?"[":""),o=-1!=t.data.highlight.indexOf(",")?"]":"";t.data.highlight.replace(/ /g,"").replace(/\[/g,"").replace(/\]/g,"")!=s.highlight?";highlight:"+n+t.data.highlight.replace(/ /g,"").replace(/\[/g,"").replace(/\]/g,"").replace(/,$/g,"")+o:"",t.data.tabsize!=s.tabsize?";tab-size:"+t.data.tabsize:""}i=e.dom.create("pre",{"class":"language-"+l},a),u?e.dom.replace(i,h):e.insertContent(e.dom.getOuterHTML(i)+"<br>")}var l,i,n,o,c=(e.dom,e.selection),r={},s={},g="markup",u=!1,h=c.getNode();s.autolinks=!0,s.collapse=!1,s.firstline="1",s.gutter=!0,s.highlight="",s.htmlscript=!1,s.tabsize="4",s.toolbar=!0,r.language="",r.autolinks=s.autolinks,r.collapse=s.collapse,r.firstline=s.firstline,r.gutter=s.gutter,r.highlight=s.highlight,r.htmlscript=s.htmlscript,r.tabsize=s.tabsize,r.toolbar=s.toolbar;var p=[{text:"Language",value:""},{text:"ActionScript3",value:"as3"},{text:"Bash/shell",value:"bash"},{text:"ColdFusion",value:"cf"},{text:"C#",value:"csharp"},{text:"C++",value:"cpp"},{text:"CSS",value:"css"},{text:"Delphi",value:"delphi"},{text:"Diff",value:"diff"},{text:"Erlang",value:"erl"},{text:"Groovy",value:"groovy"},{text:"HTML",value:"markup"},{text:"Java",value:"java"},{text:"JavaFX",value:"jfx"},{text:"JavaScript",value:"js"},{text:"Perl",value:"perl"},{text:"PHP",value:"php"},{text:"PowerShell",value:"ps"},{text:"Python",value:"py"},{text:"Ruby",value:"ruby"},{text:"Scala",value:"scala"},{text:"SQL",value:"sql"},{text:"Text",value:"plain"},{text:"Visual Basic",value:"vb"},{text:"XML",value:"xml"}];"pre"==h.nodeName.toLowerCase()&&-1!=h.className.indexOf("language-")?(u=!0,n=$(h).html(),n=n.replace(/\&lt\;/gi,"<").replace(/\&gt\;/gi,">"),o=h.className,o=o.replace(/ /g,""),t(o)):(n=c.getContent({format:"text"}),r.autolinks=!1,r.toolbar=!1);for(var d=0;d<p.length;d++)p[d].value==r.language&&(p[d].selected=!0);r.code=n,"&nbsp;"==r.code&&(r.code=""),l=e.windowManager.open({title:"SH4TinyMCE - Code Editor",data:r,minWidth:450,body:[{name:"language",type:"listbox",values:p},{name:"code",type:"textbox",minHeight:200,multiline:!0},{type:"container",layout:"flex",direction:"row",align:"center",spacing:7,items:[{name:"collapse",type:"checkbox",text:"Collapse",checked:r.collapse},{name:"autolinks",type:"checkbox",text:"Autolinks",checked:r.autolinks},{name:"gutter",type:"checkbox",text:"Gutter",checked:r.gutter},{name:"htmlscript",type:"checkbox",text:"Html script",checked:r.htmlscript},{name:"toolbar",type:"checkbox",text:"Toolbar",checked:r.toolbar}]},{type:"form",padding:0,labelGap:5,spacing:5,direction:"row",items:[{name:"firstline",type:"textbox",label:"First Line",size:3,value:r.firstline},{name:"highlight",type:"textbox",label:"Highlight",size:10,value:r.highlight},{name:"tabsize",type:"textbox",label:"Tab size",size:3,value:r.tabsize}]}],onsubmit:a})}tinymce.DOM.loadCSS(t+"/style/style.css"),e.addButton("sh4tinymce",{icon:"sh4tinymce",tooltip:"Insert/Edit Code",onclick:a}),e.addMenuItem("sh4tinymce",{text:"SH4TinyMCE",icon:"sh4tinymce",context:"insert",onclick:a})});